---
import type { BlogEntry } from "@/types";
import { getPages } from "@/lib/contentParser.astro";
import { getTaxa } from "@/lib/taxonomyParser.astro";
import taxonomyFilter from "@/lib/utils/taxonomyFilter";
import TaxonSingle from "@layouts/TaxonSingle.astro";

export async function getStaticPaths() {
  const taxa = await getTaxa("blog", "categories");
  const paths = taxa.map((taxon) => ({
    params: {
      category: taxon,
    },
    props: { taxon },
  }));
  return paths;
}

const { taxon } = Astro.props;
const entries = await getPages("blog") as BlogEntry[];
const filteredEntries: BlogEntry[] = taxonomyFilter(entries, "categories", taxon!);
---

<TaxonSingle taxon={taxon} entries={filteredEntries} />
